<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport"
	content="width=device-width, height=device-height, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">

<title>BBDP</title>

<!-- Shortcut Icon -->
<link rel="Shortcut Icon" type="image/x-icon"
	href="picture/doctor-frame/icon.ico">

<!-- Bootstrap Core CSS -->
<link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

<!-- MetisMenu CSS -->
<link href="vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link href="dist/css/sb-admin-2.css" rel="stylesheet">

<!-- Custom Fonts -->
<link href="vendor/font-awesome/css/font-awesome.min.css"
	rel="stylesheet" type="text/css">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

<!-- jQuery -->
<!-- <script src="vendor/jquery/jquery.min.js"></script> -->
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<!-- 有關下拉式選單 -->
<script src="vendor/bootstrap/js/bootstrap.min.js"></script>

<!-- Metis Menu Plugin JavaScript -->
<!-- 有關下拉式選單 -->
<script src="vendor/metisMenu/metisMenu.min.js"></script>

<!-- Custom Theme JavaScript -->
<!-- 有關下拉式選單 -->
<script src="dist/js/sb-admin-2.js"></script>
<script src="http://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
<script src="js/questionFrame.js"></script>
<script src="js/modalGenerator.js"></script>
<!-- 醫生端框架css -->
<link href="css/doctorFrame.css" rel="stylesheet" type="text/css">
<style type="text/css">
	.lattice {
		border: 3px solid #f0f0f0;
	}
	ul{ list-style-type:none;}
	li{
	
		padding: 0;
		list-style-type:none;
	}
	.myMOUSE{ cursor: move; }
	.modal-body {
    	max-height: 70vh;
	}
	h5 {
	 font-weight:bold;
	 }
</style>
<script>
	//一進來就先判斷是否已經登入，沒有的話自動跳轉至登入頁面
	$(document).ready(function() {
		if(!(window.localStorage.getItem('login'))){
		
		window.location.href = 'Login.html';
		}
	})
</script>
<script>
	var user = window.localStorage.getItem('login');
	var score=0;
	var content=500;
	var judgment = 1;
	var answerNumber = 0;
	var url = window.location.href;
 	var qparts = url.split("?");
 	var QPID = qparts[1].split("=");
	var nowQP = QPID[1];
	var editQuestion = 0; 	//是否有改題目，給病歷摘要
	var optionNumber = 0;
	var QPmedicalRecord = [];
	var nowOption = 1;
	var catchOptionNumber = [];
	var previousOption;
	var sortNum = 0;
	var allClickBtn = 0;
	var tempNumMR = 0;
	function changeanswer(){
		//var s =  $('#QType option:selected').val();
		QPmedicalRecord = [];
		$('#MCQ').empty();
		score=0;
		content=500;
	}		

	function changeType(){
		var s =  $('#QPType1 option:selected').val();
		if(s=="all"){
			document.getElementById('QPType2').disabled=false;
			judgment = 1;
		}else{
			judgment = 0;
			document.getElementById('QPType2').disabled=true;
		}
	}			
		
	
	function addanswer(){
		var s =  $('#QType option:selected').val();
		editQuestion = 1;
		if(s=="單選題"){
			if(answerNumber<10){
				score+=1;
				content+=1;
				answerNumber+=1;
				$("#MCQ").append("<div id = 'd"+score+"'><input type='number' class='form-control' style='width:15%;display:inline;	vertical-align:middle;' id='"+score+"'placeholder='分數'>&nbsp;<input type='text' class='form-control' style='width:65%;display:inline;	vertical-align:middle;' id='"+content+"'placeholder='請輸入選項'>&nbsp;<button type='button' class='btn btn-default'  style='background-color:#f0f0f0;display:inline;vertical-align:middle;'onClick='deleteAnswer("+score+")'>刪除</button><br><div style='height:7px'></div></div>");
			}else
				window.modalGenerator("提示", "最多10個選項");
			
		}else
			window.modalGenerator("提示", "請切換題型");
	}
	
	function deleteAnswer(tempNumber){
		var optionNum = 0;
		for(var i=501;i<=tempNumber+500;i++){
			if($('#'+i).val())
				optionNum+=1;
		}

		if(optionNum==nowOption){
			nowOption=1;
		}
		for(var j=optionNum;j<catchOptionNumber.length-1;j++){
			QPmedicalRecord[j] = QPmedicalRecord[j+1];
		
		}

		QPmedicalRecord.pop();
		var s =  $('#QType option:selected').val();
		if(s=="單選題"){
			$('#d'+tempNumber).remove();
			answerNumber-=1;
		}else
			window.modalGenerator("提示", "無可刪除選項");
	}
			
		
	function answerString(){
		var ans="[";
		var j;
		for(var i=1;i<=score;i++){
			j=i+500;
			if($('#'+j).val()){
				ans+="{";
				ans+='"score":';
				if($('#'+i).val())
					ans += $('#'+i).val()+',';
				else
					ans += '0,';
				ans+='"content":';
				ans += '"'+$('#'+j).val()+'"}';
				ans +=',';
			}
		}
		
		var reg=/,$/gi;
		ans=ans.replace(reg,"");
		ans+="]";
		return ans;			
	}
		
	$(document).ready(function() {
		$.ajax({
			url : "http://140.121.197.130:8000/BBDPDoctor/QuestionnairePoolServlet",
			data : {
				state : "editQuestion",
				edit : "Qname",
				doctorID : user,
				nowQP : nowQP
			},
		
			success : function(response) {
				$("#QPname").attr('value',response);
			},
			error : function() {

			}
		});		
		$.ajax({
			url : "http://140.121.197.130:8000/BBDPDoctor/QuestionnairePoolServlet",
			data : {
				state : "editQuestion",
				edit : "other",
				doctorID : user,
				nowQP : nowQP,
				async: false
			},
			dataType : "json",
			success : function(response) {
				$("#QType").val("單選題").change();
				 changeanswer();
				for(var i =0;i<response.length;i++){
					tempNumMR+=1;
					addanswer();
					$("#"+score).attr('value',response[i].score);
					$("#"+content).attr('value',response[i].content);

				}
				ajaxNext();
				
			},
			error : function() {
				$("#QType").val("簡答題").change();
				tempNumMR = 1;
				ajaxNext();
			}
		});
		
		$.ajax({
			url : "http://140.121.197.130:8000/BBDPDoctor/QuestionnairePoolServlet",
			data : {
				state : "editQuestion",
				edit : "Qtype",
				doctorID : user,
				nowQP : nowQP
			},
	
			success : function(response) {
				$("#QPType2").attr('value',response);
			},
			error : function() {
				console.log("錯誤訊息");
			}
		});			
		
		
		$("#hideAjaxBtn").click(function() {			//隱藏題目

			$.ajax({
				url : "http://140.121.197.130:8000/BBDPDoctor/QuestionnairePoolServlet",
				data : {
					state : "hideQuestion",
					doctorID : user,
					nowQP : nowQP
				},
				
				success : function(response) {
					if(response>0){
						window.location.href = "QuestionnairePool.html";
					}
				},
				error : function() {
					console.log("錯誤訊息");
				}
			});;
		
		});	
		
			
		$.ajax({
			url : "http://140.121.197.130:8000/BBDPDoctor/QuestionnairePoolServlet",
			data : {
				state : "searchQPType",
				doctorID : user									
			},
			dataType : "json",
		
			success : function(response) {
				$("#QPType1").empty();
				$("#QPType").empty();
				var temp="<option value='all'>題目分類</option>";
				for(var i=0;i<response.length;i++){
					temp+="<option value='"+response[i]+"'>"+response[i]+"</option>";
				}	
				temp+="</select>";
				$("#QPType1").append(temp);	
				$("#QPType").append(temp);
			},
			error : function() {
				console.log("錯誤訊息");
			}
		});
		
		
		$('.can_darg').css('cursor', 'move'); //滑鼠標

		$("#sortable").sortable({
			scroll: true,
			axis: "y", //只能上下垂直拖拉
			containment: "#sortQMR", //限制範圍，避免拖拉出界外
			handle: ".can_darg",
			cursor: "ns-resize", //滑鼠標

			stop: function(event, ui) { //只有要拖拉，並且停止後

			},
			update: function(event, ui) { //拖拉，並且有更換動作

			}
		}).disableSelection(); //讓拖拉作用區塊內的文字無法被選取
		
		$(document).on('click', '.remove', function(e) { //刪除排序元件
 
			$(this).closest($(this)).parent().parent().remove();
		});

		$(document).on('click', '#addQuestionTitle', function(e) { //綁上層的元素事件
			sortNum+=1;
			$(".sortQuestionnaire").append("<li class='dyn_div' id = 'sort_"+sortNum+"' style='	margin-left:-3em;'><div><img src='picture/move.png' class='can_darg myMOUSE' style='width: 30px; height: 30px;'>&nbsp;<input type='text' id='text"+sortNum+"' class='form-control' style='width:70%;display:inline;	vertical-align:middle;' value='"+$("#QPname").val()+"'>&nbsp;<button type='button' class='btn btn-default remove'  style='background-color:#f0f0f0;display:inline;vertical-align:middle;'>刪除</button></div><div style='height:7px'></div></li>");
		
		});
		
		$(document).on('click', '#addQuestionOption', function(e) { //綁上層的元素事件
			sortNum+=1;
			var num = catchOptionNumber[nowOption];
			if($("#allOption").prop("checked")){
				$(".sortQuestionnaire").append("<li class='dyn_div' id = 'sort_"+sortNum+"' style='	margin-left:-3em;'><div><img src='picture/move.png' class='can_darg myMOUSE' style='width: 30px; height: 30px;'>&nbsp;<input type='text' id='text"+sortNum+"' class='form-control' style='width:70%;display:inline;	vertical-align:middle; background-color:#D2F898;border:0px' value='病患選擇答案' readonly='readonly'>&nbsp;<button type='button' class='btn btn-default remove'  style='background-color:#f0f0f0;display:inline;vertical-align:middle;'>刪除</button></div><div style='height:7px'></div></li>");

			}else{
				if($('#QType option:selected').val()=="單選題"){
					$(".sortQuestionnaire").append("<li class='dyn_div' id = 'sort_"+sortNum+"' style='	margin-left:-3em;'><div><img src='picture/move.png' class='can_darg myMOUSE' style='width: 30px; height: 30px;'>&nbsp;<input type='text' id='text"+sortNum+"' class='form-control' style='width:70%;display:inline;	vertical-align:middle;' value='"+$("#"+num).val()+"'>&nbsp;<button type='button' class='btn btn-default remove'  style='background-color:#f0f0f0;display:inline;vertical-align:middle;'>刪除</button></div><div style='height:7px'></div></li>");	
				}else
					$(".sortQuestionnaire").append("<li class='dyn_div' id = 'sort_"+sortNum+"' style='	margin-left:-3em;'><div><img src='picture/move.png' class='can_darg myMOUSE' style='width: 30px; height: 30px;'>&nbsp;<input type='text' id='text"+sortNum+"' class='form-control' style='width:70%;display:inline;	vertical-align:middle;background-color:#D2F898;border:0px' value='病患輸入答案' readonly='readonly'>&nbsp;<button type='button' class='btn btn-default remove'  style='background-color:#f0f0f0;display:inline;vertical-align:middle;'>刪除</button></div><div style='height:7px'></div></li>");
			}
		});		

		$(document).on('click', '#addQuestionText', function(e) { //綁上層的元素事件
			sortNum+=1;
			$(".sortQuestionnaire").append("<li class='dyn_div' id = 'sort_"+sortNum+"' style='	margin-left:-3em;'><div><img src='picture/move.png' class='can_darg myMOUSE' style='width: 30px; height: 30px;'>&nbsp;<input type='text' id='text"+sortNum+"' class='form-control' style='width:70%;display:inline;	vertical-align:middle;'>&nbsp;<button type='button' class='btn btn-default remove'  style='background-color:#f0f0f0;display:inline;vertical-align:middle;'>刪除</button></div><div style='height:7px'></div></li>");		
		});	
		
		
		
		
	});
	
	function ajaxNext(){
		$.ajax({
			url : "http://140.121.197.130:8000/BBDPDoctor/QuestionnairePoolServlet",
			data : {
				state : "editQuestion",
				edit : "medicalRecord",
				doctorID : user,
				nowQP : nowQP,
				async: false
			},
	
			success : function(response) {
				var myMR = new Object();
				myMR = JSON.parse(response);
				if(myMR.all=="true") allClickBtn = 1;
				for(var i=0;i<=tempNumMR;i++){
					if(myMR[i])
						QPmedicalRecord[i] = myMR[i];
				}
				console.log(QPmedicalRecord);
			},
			error : function() {
				console.log("錯誤訊息");
			}
		});
	
	
	}
	
	function transferMRtoString(){
		var myMR = new Object();
		if(allClickBtn)
			myMR.all = "true";		
		else
			myMR.all = "false";	
			
		for(var i=0;i<QPmedicalRecord.length;i++){
			if(QPmedicalRecord[i]){
				myMR[i] = QPmedicalRecord[i];
			
			}	
		}
		return JSON.stringify(myMR);
	}
	
	function runMedicalRecord(){
		$("#sortable").empty();
		var temp ="";
		var optionTemp="";
		var oldSaveOption="";
		optionNumber = 0;
		sortNum = 0;
		$("#medicalRecordArea").empty();
		temp+="<div class='panel' style='border-color:#D2F898;width:100%;'><div class='panel-heading' style='background-color:#D2F898;'>"+$("#QPname").val()+"</div>";
		if($('#QType option:selected').val()=="單選題"){
			temp+="<div class='panel-body' style='min-height: 15vh; max-height: 15vh; overflow-y: auto;'>";
			for(var i=501;i<=content;i++){
				if($('#'+i).val()){
					optionNumber+=1;
					catchOptionNumber[optionNumber] = i;
					temp+="選項 "+optionNumber+" ："+$('#'+i).val()+"<br>";
					if(optionNumber==nowOption)
						optionTemp += '<option value="'+optionNumber+'" selected>選項'+optionNumber+'</option>';
					else
						optionTemp += '<option value='+optionNumber+'>選項'+optionNumber+'</option>';
				}
			}
			temp+="</div></div>";
			if(allClickBtn){
				temp+='<label><input type="checkbox" id="allOption" onchange="selectAll()"checked>&nbsp;套用於全部選項</label>&nbsp;&nbsp;<select class="form-control" id="editQMR" style="width:35%;display:inline;"onChange="changeEditQMR()"disabled>';
				nowOption=0;
			}
			else
				temp+='<label><input type="checkbox" id="allOption" onchange="selectAll()">&nbsp;套用於全部選項</label>&nbsp;&nbsp;<select class="form-control" id="editQMR" style="width:35%;display:inline;"onChange="changeEditQMR()">';
			temp+=optionTemp+'</select><br><br>';
			
			if(optionNumber==0)
				noOption(true);
			else
				noOption(false);
		}
		else {
			temp+="</div>";
			
		}
		
		addSaveMR();
		$("#medicalRecordArea").append(temp);
	}
	function addSaveMR(){
		
		if(QPmedicalRecord[nowOption]){
			var tempOption = QPmedicalRecord[nowOption].split(" ");
			for(var i = 0;i<tempOption.length-1;i++){
				sortNum+=1;
				if(tempOption[i]=="病患選擇答案")
					$(".sortQuestionnaire").append("<li class='dyn_div' id = 'sort_"+sortNum+"' style='	margin-left:-3em;'><div><img src='picture/move.png' class='can_darg myMOUSE' style='width: 30px; height: 30px;'>&nbsp;<input type='text' id='text"+sortNum+"' class='form-control' style='width:70%;display:inline;	vertical-align:middle; background-color:#D2F898;border:0px' value='病患選擇答案' readonly='readonly'>&nbsp;<button type='button' class='btn btn-default remove'  style='background-color:#f0f0f0;display:inline;vertical-align:middle;'>刪除</button></div><div style='height:7px'></div></li>");
				else if(tempOption[i]=="病患輸入答案")
					$(".sortQuestionnaire").append("<li class='dyn_div' id = 'sort_"+sortNum+"' style='	margin-left:-3em;'><div><img src='picture/move.png' class='can_darg myMOUSE' style='width: 30px; height: 30px;'>&nbsp;<input type='text' id='text"+sortNum+"' class='form-control' style='width:70%;display:inline;	vertical-align:middle; background-color:#D2F898;border:0px' value='病患輸入答案' readonly='readonly'>&nbsp;<button type='button' class='btn btn-default remove'  style='background-color:#f0f0f0;display:inline;vertical-align:middle;'>刪除</button></div><div style='height:7px'></div></li>");
				else	
					$(".sortQuestionnaire").append("<li class='dyn_div' id = 'sort_"+sortNum+"' style='	margin-left:-3em;'><div><img src='picture/move.png' class='can_darg myMOUSE' style='width: 30px; height: 30px;'>&nbsp;<input type='text' id='text"+sortNum+"' class='form-control' style='width:70%;display:inline;	vertical-align:middle;' value='"+tempOption[i]+"'>&nbsp;<button type='button' class='btn btn-default remove'  style='background-color:#f0f0f0;display:inline;vertical-align:middle;'>刪除</button></div><div style='height:7px'></div></li>");		
			}
		}
	
	}
	
	function selectAll(){
		changeEditQMR();
		if($("#allOption").prop("checked")){
			allClickBtn = 1;
			$("#editQMR").prop("disabled",true);
			previousOption = nowOption;
			nowOption = 0;
		}else{
			allClickBtn = 0;
			$("#editQMR").prop("disabled",false);
			nowOption = previousOption;
		}
		$("#sortable").empty();
		addSaveMR();
	}
	
	
	function changeEditQMR(){
		var sortQ = $("#sortable").sortable('serialize');
		var temp = "";
		var temp2= "";
		if(sortQ){
			var temp1 = sortQ.split("&");
		
			for(var i=0;i<temp1.length;i++){
				temp += temp1[i];
			}	
			temp2 = temp.split("sort[]=");
		}
		temp ="";
		for(var i=1;i<temp2.length;i++){
			if($("#text"+temp2[i]).val()){
				temp += $("#text"+temp2[i]).val();
				temp +=" ";
			}
		}
		QPmedicalRecord[nowOption] = null;
		if(temp)
			QPmedicalRecord[nowOption] = temp;
			
		$("#sortable").empty();
		
		if($("#editQMR").val())
			nowOption = $("#editQMR").val();

		addSaveMR();
	
	}
	
	function MROK(){
		editQuestion = 0;
		changeEditQMR();	
	}
	
	function noOption(bool){
		$("#addQuestionTitle").prop("disabled", bool);
		$("#addQuestionOption").prop("disabled", bool);
		$("#addQuestionText").prop("disabled", bool);
	}
	
	function gotoSave(){
		editQuestion=0;
		doAjaxBtn();
	}
	function doAjaxBtn(){		//儲存題目
		var QPAns ="";
		var qt =  $('#QType option:selected').val();
		if(qt=="單選題") QPAns = answerString();
		if($('#QPname').val()){
			if((judgment == 1 && $('#QPType2').val())||judgment == 0){
				if(qt=="簡答題" || QPAns!="[]"){
					var temp;
					if(judgment==1) temp=$('#QPType2').val();
					else {
						temp=$('#QPType1 option:selected').val();
					}
					if(editQuestion==1){
						$('#updateMR').modal('show');
					}
					if(editQuestion==0){
						jsonMR = transferMRtoString();
						$.ajax({
							url : "http://140.121.197.130:8000/BBDPDoctor/QuestionnairePoolServlet",
							data : {
								state : "updateQuestion",
								doctorID : user,
								QPname : $('#QPname').val(),
								QType : temp,
								QPType : $('#QType option:selected').val(),
								QPanswer : QPAns,
								nowQP : nowQP,
								MR : jsonMR
							},
							dataType : "json",
						
							success : function(response) {
								if (response>0) {
									window.location.href = 'QuestionnairePool.html';
								}else if (response==0) {
									window.modalGenerator("提示", "此題目名稱已存在");								
								}
							},
							error : function() {
								console.log("錯誤訊息");
							}
						});
					}
				}else window.modalGenerator("提示", "請加入選項");
			}else window.modalGenerator("提示", "請選擇或新增分類");
		}else window.modalGenerator("提示", "請輸入問卷名稱");
	}	
	
</script>
</head>

<body>

	<div id="wrapper">

		<!-- Navigation -->
		<nav class="navbar navbar-default navbar-static-top" role="navigation"
			style="margin-bottom: 0"></nav>

		<!-- page-wrapper -->
		<div id="page-wrapper">
			<div class="row">
				<div class = "col-sm-4">
					<br>
					<div class = "col-sm-12">
					<div>
					<button type="button" class="btn btn-default" style="background-color:#f0f0f0;font-size:13px;"onclick="location.href='NewQuestionnairePool.html'">新增題目</button>&nbsp;&nbsp;
					<button type="button" class="btn btn-default" style="background-color:#f0f0f0;font-size:13px;"onclick="addTempStorage()">將勾選題目加入暫存區</button>
					</div>
					<br>
					    <div class="panel panel-default lattice left-list" style="border: 4px solid #f0f0f0;">
							<div class="panel-heading">							
								<form method="post"	action = "">
									<select class="form-control" id="QPType" style="width:80%;">
										<option value="all">題目分類</option>
									</select>	
								</form>
							</div>
							<div class="panel-body" style="min-height: 70vh; max-height: 70vh; overflow-y: auto;" id="QuestionList"></div>
						</div>

					</div>
				</div>
			
				<div class = "col-sm-8">
					<br>
					<div>
						<input type="button" onclick ="doAjaxBtn()" class="btn btn-default" value="儲存" style="background-color:#f0f0f0;font-size:13px;float:right;">
						<div style="float:right;width:4px;height:4px;"></div>
						<input type="button" id="hideAjaxBtn" class="btn btn-default" value="隱藏" style="background-color:#f0f0f0;font-size:13px;float:right;">
						<div style="float:right;width:4px;height:4px;"></div>
						<input type="button" onclick="runMedicalRecord()" class="btn btn-default" value="病歷摘要格式" style="background-color:#f0f0f0;font-size:13px;float:right;" data-toggle="modal" data-target="#medicalRecordModal">
						
					</div>
					<div style="height:52px;"></div>
				    <div class="panel panel-default lattice right-content" style="border: 4px solid #f0f0f0;">
						<div class="panel-heading" style="background-color:#FFFFFF;">										
							<h5>題目</h5>
							<input type="text" class="form-control" id="QPname" placeholder="請輸入題目名稱...">	
							<h5>分類</h5>
							<select class="form-control" id="QPType1" style="width:35%;display:inline;"onChange="changeType()";>
								<option value="">題目分類</option>
							</select>
							<h5 style="display:inline;">&nbsp;或&nbsp;</h5>
							<input type="text" class="form-control" style="width:35%;display:inline;" id="QPType2" placeholder="請輸入要新增的分類名稱...">	
							<h5>題型</h5>
							<select class="form-control" id="QType" style="width:35%;display:inline;"onChange="changeanswer()";>
								<option value="單選題">單選題</option>
								<option value="簡答題">簡答題</option>
							</select>
						</div>
							
						<div class="panel-body" style="min-height: 46.5vh; max-height: 46.5vh; overflow-y: auto;">
							<h5>答案選項</h5>
							<div id="answer">
								<div id="MCQ">
								
								</div>
								<button type="button" class="btn btn-default" style="background-color:#f0f0f0;font-size:13px;"onClick="addanswer()" id="newanswer" >新增選項</button>
							</div>
							
						</div>
					</div>					
				</div>		
			
			
			
			
			
			
			</div>
		</div>

	</div>

  <!-- Modal -->
  <div class="modal fade" id="medicalRecordModal" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">病歷摘要格式</h4>
        </div>
        <div class="modal-body">
         	<div id="medicalRecordArea"> 
			</div>
			
			
			<div class='panel' style='border-color:#D2F898;width:100%;'>
				<div class='panel-body' id='sortQMR' style='min-height: 32vh; max-height: 32vh; overflow-y: auto;'>
					<ul class='sortQuestionnaire ui-state-default' id='sortable'>
					</ul>
				</div>
			</div>
        </div>
        <div class="modal-footer">
		  <button type="button" class="btn btn-default" style="background-color:#f0f0f0;float:left;" id ="addQuestionTitle">新增題目欄位</button>
		  <button type="button" class="btn btn-default" style="background-color:#f0f0f0;float:left;" id ="addQuestionOption">新增選項欄位</button>
		  <button type="button" class="btn btn-default" style="background-color:#f0f0f0;float:left;" id ="addQuestionText">新增文字欄位</button>
          <button type="button" class="btn btn-default" data-dismiss="modal" onclick="MROK()">完成</button>
        </div>
      </div>
      
    </div>
  </div>


	<!-- Modal -->

	<div id="updateMR" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">				
					<button type='button' class='close' data-dismiss='modal' aria-hidden='true'>×</button>
				</div>
				<div class="modal-body">
					是否更新病歷摘要？
				</div>
				<div class="modal-footer">
					<button type='button' class='btn btn-default' data-dismiss='modal'>更新</button>
					<button type='button' class='btn btn-default' data-dismiss='modal' onclick = 'gotoSave()'>不更新</button>
				</div>
			</div>
			<!-- /.modal-content -->
		</div>
		<!-- /.modal-dialog -->
	</div>
	<!-- /.modal -->
  
	<!-- 醫生端框架js -->
	<script src="js/doctorFrame.js"></script>
</body>

</html>